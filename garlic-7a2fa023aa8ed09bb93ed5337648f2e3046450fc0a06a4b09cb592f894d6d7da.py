import ca0c8b56ecd36327136ee7c527fdbb2 as utils

if __name__ == "__main__":
    standard_list = [
        "https://raw.githubusercontent.com/StevenBlack/hosts/master/hosts",
        "https://raw.githubusercontent.com/Athar5443/Youtube_BlockAds_List/main/output/hosts.ipv4.txt",
        "https://raw.githubusercontent.com/sefinek/Sefinek-Blocklist-Collection/refs/heads/main/blocklists/generated/0.0.0.0/ads/FadeMind/UncheckyAds.fork.txt",
        "https://raw.githubusercontent.com/sefinek/Sefinek-Blocklist-Collection/refs/heads/main/blocklists/generated/0.0.0.0/ads/MajkiIT/SmartTV-ads.fork.txt",
        "https://raw.githubusercontent.com/sefinek/Sefinek-Blocklist-Collection/refs/heads/main/blocklists/generated/0.0.0.0/ads/ShadowWhisperer/Ads.fork.txt",
        "https://raw.githubusercontent.com/sefinek/Sefinek-Blocklist-Collection/refs/heads/main/blocklists/generated/0.0.0.0/ads/adaway/hosts.fork.txt",
        "https://raw.githubusercontent.com/sefinek/Sefinek-Blocklist-Collection/refs/heads/main/blocklists/generated/0.0.0.0/ads/anudeepND/adservers.fork.txt",
        "https://raw.githubusercontent.com/sefinek/Sefinek-Blocklist-Collection/refs/heads/main/blocklists/generated/0.0.0.0/ads/blocklistproject/youtube.fork.txt",
        "https://raw.githubusercontent.com/sefinek/Sefinek-Blocklist-Collection/refs/heads/main/blocklists/generated/0.0.0.0/ads/blocklistproject/hosts.fork.txt",
        "https://raw.githubusercontent.com/sefinek/Sefinek-Blocklist-Collection/refs/heads/main/blocklists/generated/0.0.0.0/ads/craiu/mobiletrackers.fork.txt",
        "https://raw.githubusercontent.com/sefinek/Sefinek-Blocklist-Collection/refs/heads/main/blocklists/generated/0.0.0.0/ads/crazy-max/spy.fork.txt",
        "https://raw.githubusercontent.com/sefinek/Sefinek-Blocklist-Collection/refs/heads/main/blocklists/generated/0.0.0.0/ads/disconnectme/simple-ad.fork.txt",
        "https://raw.githubusercontent.com/sefinek/Sefinek-Blocklist-Collection/refs/heads/main/blocklists/generated/0.0.0.0/ads/firebog/Prigent-Ads.fork.txt",
        "https://raw.githubusercontent.com/sefinek/Sefinek-Blocklist-Collection/refs/heads/main/blocklists/generated/0.0.0.0/ads/firebog/AdguardDNS.fork.txt",
        "https://raw.githubusercontent.com/sefinek/Sefinek-Blocklist-Collection/refs/heads/main/blocklists/generated/0.0.0.0/ads/firebog/Admiral.fork.txt",
        "https://raw.githubusercontent.com/sefinek/Sefinek-Blocklist-Collection/refs/heads/main/blocklists/generated/0.0.0.0/ads/firebog/Easylist.fork.txt",
        "https://raw.githubusercontent.com/sefinek/Sefinek-Blocklist-Collection/refs/heads/main/blocklists/generated/0.0.0.0/ads/jerryn70/GoodbyeAds.fork.txt",
        "https://raw.githubusercontent.com/sefinek/Sefinek-Blocklist-Collection/refs/heads/main/blocklists/generated/0.0.0.0/ads/kboghdady/youtubelist.fork.txt",
        "https://raw.githubusercontent.com/sefinek/Sefinek-Blocklist-Collection/refs/heads/main/blocklists/generated/0.0.0.0/ads/r-a-y/AdguardMobileAds.fork.txt",
        "https://raw.githubusercontent.com/sefinek/Sefinek-Blocklist-Collection/refs/heads/main/blocklists/generated/0.0.0.0/ads/yoyo/ads-trackers-etc.fork.txt",
        "https://raw.githubusercontent.com/sefinek/Sefinek-Blocklist-Collection/refs/heads/main/blocklists/generated/0.0.0.0/ads/0Zinc/easylist.fork.txt",
        "https://raw.githubusercontent.com/sefinek/Sefinek-Blocklist-Collection/refs/heads/main/blocklists/generated/0.0.0.0/tracking-and-telemetry/0Zinc/easyprivacy.fork.txt",
        "https://raw.githubusercontent.com/sefinek/Sefinek-Blocklist-Collection/refs/heads/main/blocklists/generated/0.0.0.0/tracking-and-telemetry/MajkiIT/adguard-mobile-host.fork.txt",
        "https://raw.githubusercontent.com/sefinek/Sefinek-Blocklist-Collection/refs/heads/main/blocklists/generated/0.0.0.0/tracking-and-telemetry/ShadowWhisperer/tracking.fork.txt",
        "https://raw.githubusercontent.com/sefinek/Sefinek-Blocklist-Collection/refs/heads/main/blocklists/generated/0.0.0.0/tracking-and-telemetry/ente-dev/tv.fork.txt",
        "https://raw.githubusercontent.com/sefinek/Sefinek-Blocklist-Collection/refs/heads/main/blocklists/generated/0.0.0.0/tracking-and-telemetry/frogeye/firstparty-trackers-hosts.txt",
        "https://raw.githubusercontent.com/sefinek/Sefinek-Blocklist-Collection/refs/heads/main/blocklists/generated/0.0.0.0/tracking-and-telemetry/neodevpro/host.fork.txt",
        "https://raw.githubusercontent.com/sefinek/Sefinek-Blocklist-Collection/refs/heads/main/blocklists/generated/0.0.0.0/tracking-and-telemetry/quidsup/trackers-hosts.fork.txt",
        "https://blocklistproject.github.io/Lists/ads.txt",
        "https://blocklistproject.github.io/Lists/tracking.txt",
    ]

    domain_list = [
        "https://raw.githubusercontent.com/kboghdady/youTube_ads_4_pi-hole/refs/heads/master/youtubelist.txt",
        "https://raw.githubusercontent.com/Jigsaw88/Spotify-Ad-List/refs/heads/main/Spotify%20Adblock.txt",
        "https://raw.githubusercontent.com/Levi2288/AdvancedBlockList/refs/heads/main/Lists/abuse.txt",
        "https://raw.githubusercontent.com/Levi2288/AdvancedBlockList/refs/heads/main/Lists/adlist.txt",
        "https://raw.githubusercontent.com/Levi2288/AdvancedBlockList/refs/heads/main/Lists/coinmining.txt",
        "https://raw.githubusercontent.com/Levi2288/AdvancedBlockList/refs/heads/main/Lists/google_amp.txt",
        "https://raw.githubusercontent.com/Levi2288/AdvancedBlockList/refs/heads/main/Lists/malware.txt",
        "https://raw.githubusercontent.com/Levi2288/AdvancedBlockList/refs/heads/main/Lists/privacy.txt",
        "https://raw.githubusercontent.com/Levi2288/AdvancedBlockList/refs/heads/main/Lists/regex.txt",
        "https://raw.githubusercontent.com/Levi2288/AdvancedBlockList/refs/heads/main/Lists/spam.txt",
        "https://raw.githubusercontent.com/Isaaker/Spotify-AdsList/main/Lists/pi-hole-mixed.txt",
    ]

    blocklist = []

    print("Downloading and Garlic blocklist...")
    with open("b519f80650597a296dfd88f4d7a1bb23ae86d40db97e16560234a8afc48dd3b5", "r") as f:
        blocked_ips = f.read().split("\n")
        blocklist.extend(blocked_ips)
        print(f"Loaded {len(blocked_ips)} entries, total is now {len(blocklist)}")

    print("Downloading standard blocklists...")
    for url in standard_list:
        print(f"Downloading from {url}...")
        try:
            raw_list = utils.download_list(url)
            cleaned_list = utils.remove_comments(raw_list)
            blocklist.extend(cleaned_list)
            print(f"Downloaded {len(cleaned_list)} entries, total is now {len(blocklist)}")
        except Exception as e:
            print(f"Failed to download or process {url}: {e}")

    for url in domain_list:
        print(f"Downloading from {url}...")
        try:
            raw_list = utils.download_list(url)
            cleaned_list = utils.remove_comments(raw_list)
            blocked_ips = utils.add_block_ip(cleaned_list)
            blocklist.extend(blocked_ips)
            print(f"Downloaded {len(cleaned_list)} entries, total is now {len(blocklist)}")
        except Exception as e:
            print(f"Failed to download or process {url}: {e}")

    print("Removing duplicates...")
    blocklist = utils.make_unique(blocklist)

    print(f"Total unique entries: {len(blocklist)}")

    print("Adding header...")
    header_lines = utils.header(len(blocklist))
    final_list = header_lines + blocklist

    output_file = "garlic_blocklist.txt"
    print(f"Writing to {output_file}...")
    with open(output_file, "w") as f:
        f.write("\n".join(final_list))

    print("Done.")
